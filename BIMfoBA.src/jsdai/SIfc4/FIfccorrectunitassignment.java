/* Generated by JSDAI Express Compiler, version 4.3.2, build 500, 2011-12-13 */

// Java class implementing EXPRESS function IfcCorrectUnitAssignment

package jsdai.SIfc4;
import jsdai.lang.*;










public class FIfccorrectunitassignment {
	
	// declaration of non-VAR parameters
	Value _nonvar__e_Units;
	// end of declaration of non-VAR parameters

	// declaration of local variables
	Value _e_NamedUnitNumber;
	Value _e_DerivedUnitNumber;
	Value _e_MonetaryUnitNumber;
	Value _e_NamedUnitNames;
	Value _e_DerivedUnitNames;
	// end of declaration of local variables


	public Value run(SdaiContext _context, Value _e_Units) throws SdaiException {

		// initialization of non-VAR parameters
		_nonvar__e_Units = Value.alloc(jsdai.SIfc4.SIfc4._st_generalset_1_ifcunit).set(_e_Units);
		// end of initialization of non-VAR parameters

		// initialization of local variables
		_e_NamedUnitNumber = Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, 0));
		_e_DerivedUnitNumber = Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, 0));
		_e_MonetaryUnitNumber = Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, 0));
		_e_NamedUnitNames = Value.alloc(jsdai.SIfc4.SIfc4._st_generalset_0_ifcunitenum).create();
		_e_DerivedUnitNames = Value.alloc(jsdai.SIfc4.SIfc4._st_generalset_0_ifcderivedunitenum).create();
		// end of initialization of local variables




																
																Value _internal_aggregate_source407 = _nonvar__e_Units;
																Value _result405 = Value.alloc(_internal_aggregate_source407).create();
																if (_internal_aggregate_source407.getActualJavaType() != Value.INDETERMINATE) {
																	for (int _i406 = 1; _i406 <= _internal_aggregate_source407.getMemberCount(); _i406++) {
																		Value _implicit_93_temp = _internal_aggregate_source407.getByIndex(_i406);
																		if (Value.alloc(ExpressTypes.LOGICAL_TYPE).AND(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).IN(_context, Value.alloc(ExpressTypes.STRING_TYPE).set(_context, "*.IFCNAMEDUNIT", "IFC4"), _implicit_93_temp.typeOfV(_context)), Value.alloc(ExpressTypes.LOGICAL_TYPE).NOT(Value.alloc(ExpressTypes.LOGICAL_TYPE).equal(_context, _implicit_93_temp.groupReference(_context, jsdai.SIfc4.CIfcnamedunit.class).getAttribute("unittype", _context), Value.alloc(jsdai.SIfc4.SIfc4._st_IfcUnitEnum).setEnum(_context, "USERDEFINED")))).getLogical() == 2) {
																			_result405.addMember(_context, _implicit_93_temp);
																		} else
																		if (_internal_aggregate_source407.getDeclaredType() instanceof jsdai.dictionary.EArray_type) {
																			_implicit_93_temp.unset();
																			_result405.addMember(_context, _implicit_93_temp);
																		}
																	}
																} else {
																	_result405.unset();
																}

																_e_NamedUnitNumber.set(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).sizeOf(_result405));


																
																Value _internal_aggregate_source411 = _nonvar__e_Units;
																Value _result409 = Value.alloc(_internal_aggregate_source411).create();
																if (_internal_aggregate_source411.getActualJavaType() != Value.INDETERMINATE) {
																	for (int _i410 = 1; _i410 <= _internal_aggregate_source411.getMemberCount(); _i410++) {
																		Value _implicit_94_temp = _internal_aggregate_source411.getByIndex(_i410);
																		if (Value.alloc(ExpressTypes.LOGICAL_TYPE).AND(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).IN(_context, Value.alloc(ExpressTypes.STRING_TYPE).set(_context, "*.IFCDERIVEDUNIT", "IFC4"), _implicit_94_temp.typeOfV(_context)), Value.alloc(ExpressTypes.LOGICAL_TYPE).NOT(Value.alloc(ExpressTypes.LOGICAL_TYPE).equal(_context, _implicit_94_temp.groupReference(_context, jsdai.SIfc4.CIfcderivedunit.class).getAttribute("unittype", _context), Value.alloc(jsdai.SIfc4.SIfc4._st_IfcDerivedUnitEnum).setEnum(_context, "USERDEFINED")))).getLogical() == 2) {
																			_result409.addMember(_context, _implicit_94_temp);
																		} else
																		if (_internal_aggregate_source411.getDeclaredType() instanceof jsdai.dictionary.EArray_type) {
																			_implicit_94_temp.unset();
																			_result409.addMember(_context, _implicit_94_temp);
																		}
																	}
																} else {
																	_result409.unset();
																}

																_e_DerivedUnitNumber.set(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).sizeOf(_result409));


																
																Value _internal_aggregate_source415 = _nonvar__e_Units;
																Value _result413 = Value.alloc(_internal_aggregate_source415).create();
																if (_internal_aggregate_source415.getActualJavaType() != Value.INDETERMINATE) {
																	for (int _i414 = 1; _i414 <= _internal_aggregate_source415.getMemberCount(); _i414++) {
																		Value _implicit_95_temp = _internal_aggregate_source415.getByIndex(_i414);
																		if (Value.alloc(ExpressTypes.LOGICAL_TYPE).IN(_context, Value.alloc(ExpressTypes.STRING_TYPE).set(_context, "*.IFCMONETARYUNIT", "IFC4"), _implicit_95_temp.typeOfV(_context)).getLogical() == 2) {
																			_result413.addMember(_context, _implicit_95_temp);
																		} else
																		if (_internal_aggregate_source415.getDeclaredType() instanceof jsdai.dictionary.EArray_type) {
																			_implicit_95_temp.unset();
																			_result413.addMember(_context, _implicit_95_temp);
																		}
																	}
																} else {
																	_result413.unset();
																}

																_e_MonetaryUnitNumber.set(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).sizeOf(_result413));


																Value _end416 = Value.alloc(ExpressTypes.NUMBER_TYPE).set(Value.alloc(ExpressTypes.INTEGER_TYPE).sizeOf(_nonvar__e_Units));
																Value _step416 = Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, 1);
																for (Value _implicit_96_i=Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, 1);Value.alloc(ExpressTypes.LOGICAL_TYPE).lequal(_context, _implicit_96_i, _end416).getLogical() == 2;_implicit_96_i.inc(_step416)) {																
																	if (Value.alloc(ExpressTypes.LOGICAL_TYPE).AND(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).IN(_context, Value.alloc(ExpressTypes.STRING_TYPE).set(_context, "*.IFCNAMEDUNIT", "IFC4"), _nonvar__e_Units.indexing(_implicit_96_i, null).typeOfV(_context)), Value.alloc(ExpressTypes.LOGICAL_TYPE).NOT(Value.alloc(ExpressTypes.LOGICAL_TYPE).equal(_context, _nonvar__e_Units.indexing(_implicit_96_i, null).groupReference(_context, jsdai.SIfc4.CIfcnamedunit.class).getAttribute(jsdai.SIfc4.CIfcnamedunit.attributeUnittype(null), _context), Value.alloc(jsdai.SIfc4.SIfc4._st_IfcUnitEnum).setEnum(_context, "USERDEFINED")))).getLogical() == 2) {																	
																		_e_NamedUnitNames.set(_context, Value.alloc().addOrUnionOrConcatenate(_context, _e_NamedUnitNames, _nonvar__e_Units.indexing(_implicit_96_i, null).groupReference(_context, jsdai.SIfc4.CIfcnamedunit.class).getAttribute(jsdai.SIfc4.CIfcnamedunit.attributeUnittype(null), _context)));
																	}																	
																	if (Value.alloc(ExpressTypes.LOGICAL_TYPE).AND(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).IN(_context, Value.alloc(ExpressTypes.STRING_TYPE).set(_context, "*.IFCDERIVEDUNIT", "IFC4"), _nonvar__e_Units.indexing(_implicit_96_i, null).typeOfV(_context)), Value.alloc(ExpressTypes.LOGICAL_TYPE).NOT(Value.alloc(ExpressTypes.LOGICAL_TYPE).equal(_context, _nonvar__e_Units.indexing(_implicit_96_i, null).groupReference(_context, jsdai.SIfc4.CIfcderivedunit.class).getAttribute(jsdai.SIfc4.CIfcderivedunit.attributeUnittype(null), _context), Value.alloc(jsdai.SIfc4.SIfc4._st_IfcDerivedUnitEnum).setEnum(_context, "USERDEFINED")))).getLogical() == 2) {																	
																		_e_DerivedUnitNames.set(_context, Value.alloc().addOrUnionOrConcatenate(_context, _e_DerivedUnitNames, _nonvar__e_Units.indexing(_implicit_96_i, null).groupReference(_context, jsdai.SIfc4.CIfcderivedunit.class).getAttribute(jsdai.SIfc4.CIfcderivedunit.attributeUnittype(null), _context)));
																	}
																} // for - REPEAT




		if (true) return Value.alloc(ExpressTypes.LOGICAL_TYPE).set(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).AND(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).AND(_context, Value.alloc(ExpressTypes.LOGICAL_TYPE).equal(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).sizeOf(_e_NamedUnitNames), _e_NamedUnitNumber), Value.alloc(ExpressTypes.LOGICAL_TYPE).equal(_context, Value.alloc(ExpressTypes.INTEGER_TYPE).sizeOf(_e_DerivedUnitNames), _e_DerivedUnitNumber)), Value.alloc(ExpressTypes.LOGICAL_TYPE).lequal(_context, _e_MonetaryUnitNumber, Value.alloc(ExpressTypes.INTEGER_TYPE).set(_context, 1)))).check(_context, ExpressTypes.LOGICAL_TYPE);

		return Value.alloc(ExpressTypes.GENERIC_TYPE).unset(); // if return is missing in express - add printing of error message?
	}

}
